<Window x:Class="DANCustomTools.Views.Dialogs.ComponentSaveDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="Component Save Configuration"
        Width="800" Height="650"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterOwner"
        Background="{StaticResource GameEditorBackgroundBrush}"
        FontFamily="Segoe UI">

    <Window.Resources>
        <Style x:Key="DialogButtonStyle" TargetType="Button" BasedOn="{StaticResource GameEditorToolButtonStyle}">
            <Setter Property="MinWidth" Value="80"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="4"/>
        </Style>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="8"/>
        </Style>

        <Style x:Key="FilePathTextBoxStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="FontFamily" Value="Consolas, Courier New, monospace"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Background" Value="{DynamicResource MaterialDesignTextFieldBoxBackground}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource MaterialDesignTextFieldBoxHoverBackground}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </Window.Resources>

    <materialDesign:Card Style="{StaticResource GameEditorCardStyle}" Margin="8">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0"
                    Background="{StaticResource GameEditorAccentBrush}"
                    Padding="16,12"
                    CornerRadius="4,4,0,0">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="ContentSave"
                                             Width="24" Height="24"
                                             VerticalAlignment="Center"
                                             Foreground="White"/>
                    <TextBlock Text="Component Save Configuration"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="White"
                               VerticalAlignment="Center"
                               Margin="12,0,0,0"/>
                </StackPanel>
            </Border>

            <!-- Content -->
            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="16">
                <StackPanel>
                    <!-- Actor Configuration -->
                    <GroupBox Header="Actor" Style="{StaticResource GroupBoxStyle}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Actor Save Type -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,8">
                                <RadioButton x:Name="RadioSaveAllInActor"
                                             Content="Save all in"
                                             IsChecked="True"
                                             Margin="0,0,16,0"/>
                                <RadioButton x:Name="RadioSaveActor"
                                             Content="Save"
                                             Margin="0,0,16,0"/>
                                <RadioButton x:Name="RadioNoSaveActor"
                                             Content="Don't save"
                                             Margin="0,0,16,0"/>
                            </StackPanel>

                            <!-- Actor Path -->
                            <Grid Grid.Row="1" Margin="0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="TextBoxActorPath"
                                         Grid.Column="0"
                                         Style="{StaticResource FilePathTextBoxStyle}"
                                         materialDesign:HintAssist.Hint="Actor file path (.act)"
                                         materialDesign:HintAssist.IsFloating="False"/>

                                <Button Grid.Column="1"
                                        Content="..."
                                        Style="{StaticResource DialogButtonStyle}"
                                        Width="40"
                                        Margin="4,0,0,0"
                                        Click="SelectActorPath_Click"/>
                            </Grid>

                            <!-- Reset Paths Button -->
                            <Button Grid.Row="2"
                                    Content="Use this path for component paths"
                                    Style="{StaticResource DialogButtonStyle}"
                                    HorizontalAlignment="Right"
                                    Width="250"
                                    Margin="0,8"
                                    Click="ResetPaths_Click"/>
                        </Grid>
                    </GroupBox>

                    <!-- Custom Separated Files -->
                    <GroupBox Header="Custom Separated Files" Style="{StaticResource GroupBoxStyle}">
                        <StackPanel>
                            <!-- Use Actor Base -->
                            <CheckBox x:Name="CheckBoxUseActorBase"
                                      Content="Use Actor Base"
                                      IsChecked="True"
                                      FontWeight="SemiBold"
                                      Margin="0,8"/>

                            <!-- Actor Base Configuration -->
                            <GroupBox x:Name="GroupBoxActorBase"
                                      Header="Actor Base"
                                      Style="{StaticResource GroupBoxStyle}"
                                      Margin="16,0,0,8">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Actor Base Save Type -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,8">
                                        <RadioButton x:Name="RadioSaveActorBase"
                                                     Content="Save"
                                                     IsChecked="True"
                                                     Margin="0,0,16,0"/>
                                        <RadioButton x:Name="RadioNoSaveActorBase"
                                                     Content="Don't save"
                                                     Margin="0,0,16,0"/>
                                    </StackPanel>

                                    <!-- Actor Base Path -->
                                    <Grid Grid.Row="1" Margin="0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBox x:Name="TextBoxActorBasePath"
                                                 Grid.Column="0"
                                                 Style="{StaticResource FilePathTextBoxStyle}"
                                                 materialDesign:HintAssist.Hint="Actor base file path (.ilu)"
                                                 materialDesign:HintAssist.IsFloating="False"/>

                                        <Button Grid.Column="1"
                                                Content="..."
                                                Style="{StaticResource DialogButtonStyle}"
                                                Width="40"
                                                Margin="4,0,0,0"
                                                Click="SelectActorBasePath_Click"/>
                                    </Grid>
                                </Grid>
                            </GroupBox>

                            <!-- Components Configuration -->
                            <GroupBox x:Name="GroupBoxComponents"
                                      Header="Components"
                                      Style="{StaticResource GroupBoxStyle}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Component Save Type Options -->
                                    <Border Grid.Row="0"
                                            BorderBrush="{DynamicResource MaterialDesignDivider}"
                                            BorderThickness="1"
                                            Padding="8"
                                            Margin="0,8"
                                            Background="{DynamicResource MaterialDesignCardBackground}">
                                        <StackPanel Orientation="Horizontal">
                                            <RadioButton x:Name="RadioSaveInActorBase"
                                                         Content="Save in actor (base)"
                                                         IsChecked="True"
                                                         Margin="0,0,16,0"
                                                         Checked="ComponentSaveType_Changed"/>
                                            <RadioButton x:Name="RadioSaveInComponent"
                                                         Content="Save in .ilu"
                                                         Margin="0,0,16,0"
                                                         Checked="ComponentSaveType_Changed"/>
                                            <RadioButton x:Name="RadioNoSaveComponents"
                                                         Content="Don't save in .ilu (caution: component file must exist)"
                                                         Margin="0,0,16,0"
                                                         Checked="ComponentSaveType_Changed"/>
                                        </StackPanel>
                                    </Border>

                                    <!-- Components List -->
                                    <ScrollViewer Grid.Row="1"
                                                  VerticalScrollBarVisibility="Auto"
                                                  MaxHeight="300">
                                        <StackPanel x:Name="PanelComponentsFiles"/>
                                    </ScrollViewer>
                                </Grid>
                            </GroupBox>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </ScrollViewer>

            <!-- Button Panel -->
            <Border Grid.Row="2"
                    Background="{DynamicResource MaterialDesignDivider}"
                    Padding="16,12">
                <Grid>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                        <Button Content="Normalize and validate paths (by engine)"
                                Style="{StaticResource DialogButtonStyle}"
                                Width="250"
                                Click="ValidatePaths_Click">
                            <Button.ToolTip>
                                <ToolTip Content="Normalize and validate all file paths using the engine"/>
                            </Button.ToolTip>
                        </Button>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <Button Style="{StaticResource DialogButtonStyle}"
                                Content="Cancel"
                                IsCancel="True"
                                Click="CancelButton_Click">
                            <Button.ToolTip>
                                <ToolTip Content="Cancel changes and close dialog"/>
                            </Button.ToolTip>
                        </Button>

                        <Button Style="{StaticResource DialogButtonStyle}"
                                Content="OK"
                                IsDefault="True"
                                Click="OkButton_Click">
                            <Button.ToolTip>
                                <ToolTip Content="Apply changes and close dialog"/>
                            </Button.ToolTip>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </materialDesign:Card>
</Window>